<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Plan Shutdown System</title>
<style>
body{font-family:Arial;background:#f2f2f2}
.card{max-width:420px;margin:auto;background:#fff;padding:20px;border-radius:10px}
input,button{width:100%;padding:10px;margin:6px 0}
button{background:#1f3a5f;color:#fff;border:none}
.hidden{display:none}
</style>
</head>

<body>

<div class="card" id="loginBox">
  <h3>Login</h3>
  <input id="loginEmail" placeholder="bhaveshparmar6@gmail.com">
  <button onclick="login()">Login</button>
  <p id="loginMsg"></p>
</div>

<div class="card hidden" id="planBox">
  <h3>Plan Shutdown Entry</h3>

  <input id="installation" placeholder="Installation">
  <input id="feeder" placeholder="Feeder">
  <input id="date" type="date">
  <input id="period" placeholder="Period">
  <input id="notify" placeholder="Notify Email">

  <button onclick="save()">Save</button>
  <p id="msg"></p>
</div>

<script>
const SCRIPT_URL =
  "https://script.google.com/macros/s/AKfycbXXXXXXXXXXXX/exec";

let loggedUser = "";

function login(){

  let email = loginEmail.value;

  fetch(SCRIPT_URL + "?action=login&email=" + encodeURIComponent(email))
    .then(r => r.text())
    .then(t => {
      if (t.startsWith("LOGIN_OK")) {
        loggedUser = email;
        loginBox.classList.add("hidden");
        planBox.classList.remove("hidden");
      } else {
        loginMsg.innerHTML = "Access Denied";
      }
    });
}

function save(){

  let url =
    SCRIPT_URL +
    "?action=saveplan" +
    "&login=" + encodeURIComponent(loggedUser) +
    "&installation=" + encodeURIComponent(installation.value) +
    "&feeder=" + encodeURIComponent(feeder.value) +
    "&date=" + date.value +
    "&period=" + encodeURIComponent(period.value) +
    "&notify=" + encodeURIComponent(notify.value);

  fetch(url)
    .then(r => r.text())
    .then(t => msg.innerHTML = t);
}
</script>

</body>
</html>
